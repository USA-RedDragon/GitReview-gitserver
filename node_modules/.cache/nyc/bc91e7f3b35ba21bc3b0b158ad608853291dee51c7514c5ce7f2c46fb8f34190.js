var cov_1836tvf46o=function(){var path="/Users/reddragon/personal/gitreview/gitserver/src/handlers/authentication.js";var hash="c48a26016d8bcaaf2a2783698047dcd1aa8dfd0a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/reddragon/personal/gitreview/gitserver/src/handlers/authentication.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:34}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:4,column:0},end:{line:20,column:2}},"3":{start:{line:5,column:4},end:{line:19,column:7}},"4":{start:{line:6,column:8},end:{line:18,column:11}},"5":{start:{line:7,column:12},end:{line:17,column:15}},"6":{start:{line:10,column:16},end:{line:14,column:19}},"7":{start:{line:11,column:20},end:{line:11,column:93}},"8":{start:{line:13,column:20},end:{line:13,column:32}},"9":{start:{line:16,column:16},end:{line:16,column:28}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:49},end:{line:20,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:5,column:23},end:{line:5,column:24}},loc:{start:{line:5,column:44},end:{line:19,column:5}},line:5},"2":{name:"(anonymous_2)",decl:{start:{line:6,column:13},end:{line:6,column:14}},loc:{start:{line:6,column:37},end:{line:18,column:9}},line:6},"3":{name:"(anonymous_3)",decl:{start:{line:9,column:20},end:{line:9,column:21}},loc:{start:{line:9,column:35},end:{line:15,column:13}},line:9},"4":{name:"(anonymous_4)",decl:{start:{line:10,column:68},end:{line:10,column:69}},loc:{start:{line:10,column:82},end:{line:12,column:17}},line:10},"5":{name:"(anonymous_5)",decl:{start:{line:12,column:25},end:{line:12,column:26}},loc:{start:{line:12,column:34},end:{line:14,column:17}},line:12},"6":{name:"(anonymous_6)",decl:{start:{line:15,column:21},end:{line:15,column:22}},loc:{start:{line:15,column:30},end:{line:17,column:13}},line:15}},branchMap:{"0":{loc:{start:{line:11,column:20},end:{line:11,column:92}},type:"cond-expr",locations:[{start:{line:11,column:31},end:{line:11,column:40}},{start:{line:11,column:43},end:{line:11,column:92}}],line:11}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"c48a26016d8bcaaf2a2783698047dcd1aa8dfd0a"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();const db=(cov_1836tvf46o.s[0]++,require('../db/models'));const argon2=(cov_1836tvf46o.s[1]++,require('argon2'));cov_1836tvf46o.s[2]++;module.exports=({type,repo,user},next)=>{cov_1836tvf46o.f[0]++;cov_1836tvf46o.s[3]++;return new Promise((resolve,reject)=>{cov_1836tvf46o.f[1]++;cov_1836tvf46o.s[4]++;user((username,password)=>{cov_1836tvf46o.f[2]++;cov_1836tvf46o.s[5]++;db.users.findOne({where:{login:username}}).then(foundUser=>{cov_1836tvf46o.f[3]++;cov_1836tvf46o.s[6]++;argon2.verify(foundUser.gitPassword,password).then(verified=>{cov_1836tvf46o.f[4]++;cov_1836tvf46o.s[7]++;verified?(cov_1836tvf46o.b[0][0]++,resolve()):(cov_1836tvf46o.b[0][1]++,reject(new Error('Invalid Username or Password')));}).catch(err=>{cov_1836tvf46o.f[5]++;cov_1836tvf46o.s[8]++;reject(err);});}).catch(err=>{cov_1836tvf46o.f[6]++;cov_1836tvf46o.s[9]++;reject(err);});});});};